#!/usr/bin/env bash

set -euo pipefail
IFS=$'\n\t'

bee::resolve_plugin() {
  local plugin="$1"
  local plugin_name="${plugin%:*}"
  local plugin_version="${plugin##*:}"
  if [[ "${plugin_name}" == "${plugin_version}" && -d "${BEE_PLUGINS_PATH}/${plugin}" ]]; then
    local latest
    latest="$(ls -d "${BEE_PLUGINS_PATH}/${plugin}/"*/ | sort -rV | head -n 1)"
    plugin_version="$(basename "${latest}")"
  fi
  local path="${BEE_PLUGINS_PATH}/${plugin_name}/${plugin_version}/${plugin_name}.sh"
  if [[ -f "${path}" ]]; then
    echo "${path}"
  fi
}

bee::main() {
  if (($# > 0)); then
    "$@"
  else
    echo "usage"
  fi
}

bee::main "$@"
